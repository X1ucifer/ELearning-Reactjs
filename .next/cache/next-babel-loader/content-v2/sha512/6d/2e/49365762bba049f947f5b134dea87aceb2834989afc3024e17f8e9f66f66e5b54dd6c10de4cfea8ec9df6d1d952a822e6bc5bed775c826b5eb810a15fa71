{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"C:/Users/AJ/Downloads/Spyberrys/Spyberrys/Spyberrys_app/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/AJ/Downloads/Spyberrys/Spyberrys/Spyberrys_app/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"C:/Users/AJ/Downloads/Spyberrys/Spyberrys/Spyberrys_app/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"C:/Users/AJ/Downloads/Spyberrys/Spyberrys/Spyberrys_app/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport { parseCookies } from 'nookies';\nimport axios from 'axios';\nimport { Spinner } from 'reactstrap';\nimport toast from 'react-hot-toast';\nimport { useRouter } from 'next/router';\nimport baseUrl from '@/utils/baseUrl';\nimport catchErrors from '@/utils/catchErrors';\nimport PageBanner from '@/components/Common/PageBanner';\nimport Link from '@/utils/ActiveLink';\nvar INIT_COURSE = {\n  title: '',\n  overview: '',\n  price: 0.00,\n  profilePhoto: '',\n  published: true,\n  coverPhoto: '',\n  course_preview_img: '',\n  course_preview_video: '',\n  duration: '',\n  lessons: '',\n  category: ''\n};\n\nvar Create = function Create() {\n  var _parseCookies = parseCookies(),\n      token = _parseCookies.token;\n\n  var router = useRouter();\n\n  var _React$useState = React.useState(INIT_COURSE),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      course = _React$useState2[0],\n      setCourse = _React$useState2[1];\n\n  var _React$useState3 = React.useState(''),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      profilePreview = _React$useState4[0],\n      setProfilePreview = _React$useState4[1];\n\n  var _React$useState5 = React.useState(''),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      coverPhotoPreview = _React$useState6[0],\n      setCoverPhotoPreview = _React$useState6[1];\n\n  var _React$useState7 = React.useState(''),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      coursePreviewImg = _React$useState8[0],\n      setCoursePreviewImg = _React$useState8[1];\n\n  var _React$useState9 = React.useState(false),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      imageUploading = _React$useState10[0],\n      setImageUploading = _React$useState10[1];\n\n  var _React$useState11 = React.useState(false),\n      _React$useState12 = _slicedToArray(_React$useState11, 2),\n      loading = _React$useState12[0],\n      setLoading = _React$useState12[1];\n\n  var _React$useState13 = React.useState(true),\n      _React$useState14 = _slicedToArray(_React$useState13, 2),\n      disabled = _React$useState14[0],\n      setDisabled = _React$useState14[1];\n\n  var _React$useState15 = React.useState(),\n      _React$useState16 = _slicedToArray(_React$useState15, 2),\n      error = _React$useState16[0],\n      setError = _React$useState16[1];\n\n  React.useEffect(function () {\n    var isCourse = Object.values(course).every(function (el) {\n      return Boolean(el);\n    });\n    isCourse ? setDisabled(false) : setDisabled(true);\n  }, [course]);\n\n  var handleChange = function handleChange(e) {\n    // console.log(d.value)\n    var _e$target = e.target,\n        name = _e$target.name,\n        value = _e$target.value,\n        files = _e$target.files;\n\n    if (name === 'profilePhoto') {\n      var profilePhotoSize = files[0].size / 1024 / 1024;\n\n      if (profilePhotoSize > 2) {\n        addToast('The profile photo size greater than 2 MB. Make sure less than 2 MB.', {\n          appearance: 'error'\n        });\n        e.target.value = null;\n        return;\n      }\n\n      setCourse(function (prevState) {\n        return _objectSpread(_objectSpread({}, prevState), {}, {\n          profilePhoto: files[0]\n        });\n      });\n      setProfilePreview(window.URL.createObjectURL(files[0]));\n    } else if (name === 'coverPhoto') {\n      var coverPhotoSize = files[0].size / 1024 / 1024;\n\n      if (coverPhotoSize > 2) {\n        addToast('The cover photo size greater than 2 MB. Make sure less than 2 MB.', {\n          appearance: 'error'\n        });\n        e.target.value = null;\n        return;\n      }\n\n      setCourse(function (prevState) {\n        return _objectSpread(_objectSpread({}, prevState), {}, {\n          coverPhoto: files[0]\n        });\n      });\n      setCoverPhotoPreview(window.URL.createObjectURL(files[0]));\n    } else if (name === 'course_preview_img') {\n      var course_preview_img = files[0].size / 1024 / 1024;\n\n      if (course_preview_img > 2) {\n        addToast('The course preview omage size greater than 2 MB. Make sure less than 2 MB.', {\n          appearance: 'error'\n        });\n        e.target.value = null;\n        return;\n      }\n\n      setCourse(function (prevState) {\n        return _objectSpread(_objectSpread({}, prevState), {}, {\n          course_preview_img: files[0]\n        });\n      });\n      setCoursePreviewImg(window.URL.createObjectURL(files[0]));\n    } else {\n      setCourse(function (prevState) {\n        return _objectSpread(_objectSpread({}, prevState), {}, _defineProperty({}, name, value));\n      });\n    } // console.log(course);\n\n  };\n\n  var handleProfilePhotoUpload = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var data, response, profilePhotoUrl;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setImageUploading(true); // console.log(post.file_url)\n\n              data = new FormData();\n              data.append('file', course.profilePhoto);\n              data.append('upload_preset', 'vikings');\n              data.append('cloud_name', 'dev-empty');\n\n              if (!course.profilePhoto) {\n                _context.next = 9;\n                break;\n              }\n\n              _context.next = 8;\n              return axios.post(process.env.CLOUDINARY_URL, data);\n\n            case 8:\n              response = _context.sent;\n\n            case 9:\n              profilePhotoUrl = response.data.url;\n              return _context.abrupt(\"return\", profilePhotoUrl);\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleProfilePhotoUpload() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var handlecoverPhotoUpload = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var data, response, cover_photo_url;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              setImageUploading(true); // console.log(post.file_url)\n\n              data = new FormData();\n              data.append('file', course.coverPhoto);\n              data.append('upload_preset', 'vikings');\n              data.append('cloud_name', 'dev-empty');\n\n              if (!course.coverPhoto) {\n                _context2.next = 9;\n                break;\n              }\n\n              _context2.next = 8;\n              return axios.post(process.env.CLOUDINARY_URL, data);\n\n            case 8:\n              response = _context2.sent;\n\n            case 9:\n              cover_photo_url = response.data.url;\n              return _context2.abrupt(\"return\", cover_photo_url);\n\n            case 11:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handlecoverPhotoUpload() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handlePreviewPhotoUpload = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var data, response, preview_photo_response_url;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              setImageUploading(true); // console.log(post.file_url)\n\n              data = new FormData();\n              data.append('file', course.course_preview_img);\n              data.append('upload_preset', 'vikings');\n              data.append('cloud_name', 'dev-empty');\n\n              if (!course.course_preview_img) {\n                _context3.next = 9;\n                break;\n              }\n\n              _context3.next = 8;\n              return axios.post(process.env.CLOUDINARY_URL, data);\n\n            case 8:\n              response = _context3.sent;\n\n            case 9:\n              preview_photo_response_url = response.data.url;\n              setImageUploading(false);\n              setLoading(true);\n              return _context3.abrupt(\"return\", preview_photo_response_url);\n\n            case 13:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function handlePreviewPhotoUpload() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var handleCourseSubmit = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e) {\n      var profile, cover, preview, url, title, overview, price, published, duration, lessons, category, course_preview_video, payload, response;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              e.preventDefault();\n              _context4.prev = 1;\n              profile = '';\n              cover = '';\n              preview = '';\n\n              if (!(course.profilePhoto && course.coverPhoto && course.course_preview_img)) {\n                _context4.next = 18;\n                break;\n              }\n\n              _context4.next = 8;\n              return handleProfilePhotoUpload();\n\n            case 8:\n              profile = _context4.sent;\n              _context4.next = 11;\n              return handlecoverPhotoUpload();\n\n            case 11:\n              cover = _context4.sent;\n              _context4.next = 14;\n              return handlePreviewPhotoUpload();\n\n            case 14:\n              preview = _context4.sent;\n              profile = profile.replace(/^http:\\/\\//i, 'https://');\n              cover = cover.replace(/^http:\\/\\//i, 'https://');\n              preview = preview.replace(/^http:\\/\\//i, 'https://');\n\n            case 18:\n              url = \"\".concat(baseUrl, \"/api/v1/courses/course/new\");\n              title = course.title, overview = course.overview, price = course.price, published = course.published, duration = course.duration, lessons = course.lessons, category = course.category, course_preview_video = course.course_preview_video;\n              payload = {\n                title: title,\n                overview: overview,\n                price: price,\n                published: published,\n                duration: duration,\n                lessons: lessons,\n                category: category,\n                profile: profile,\n                cover: cover,\n                preview: preview,\n                course_preview_video: course_preview_video\n              };\n              _context4.next = 23;\n              return axios.post(url, payload, {\n                headers: {\n                  Authorization: token\n                }\n              });\n\n            case 23:\n              response = _context4.sent;\n              // console.log(response.data)\n              setLoading(false);\n              setCourse(INIT_COURSE);\n              setProfilePreview('');\n              setCoverPhotoPreview('');\n              setCoursePreviewImg('');\n              toast.success(response.data);\n              router.replace('/teacher/course/upload-course-video');\n              _context4.next = 37;\n              break;\n\n            case 33:\n              _context4.prev = 33;\n              _context4.t0 = _context4[\"catch\"](1);\n              catchErrors(_context4.t0, setError);\n              toast.error(error);\n\n            case 37:\n              _context4.prev = 37;\n              setLoading(false);\n              return _context4.finish(37);\n\n            case 40:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[1, 33, 37, 40]]);\n    }));\n\n    return function handleCourseSubmit(_x) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxs(React.Fragment, {\n    children: [/*#__PURE__*/_jsx(PageBanner, {\n      pageTitle: \"Teacher Course Create\",\n      homePageUrl: \"/\",\n      homePageText: \"Home\",\n      activePageText: \"Teacher Course Create\"\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"ptb-100\",\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"container\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"row\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"col-md-4 col-lg-4\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"td-sidebar\",\n              children: /*#__PURE__*/_jsxs(\"ul\", {\n                children: [/*#__PURE__*/_jsx(\"li\", {\n                  children: /*#__PURE__*/_jsx(Link, {\n                    href: \"/teacher/courses\",\n                    activeClassName: \"active\",\n                    children: /*#__PURE__*/_jsx(\"a\", {\n                      children: \"My Courses\"\n                    })\n                  })\n                }), /*#__PURE__*/_jsx(\"li\", {\n                  children: /*#__PURE__*/_jsx(Link, {\n                    href: \"/teacher/course/create\",\n                    activeClassName: \"active\",\n                    children: /*#__PURE__*/_jsx(\"a\", {\n                      children: \"Create A Course\"\n                    })\n                  })\n                }), /*#__PURE__*/_jsx(\"li\", {\n                  children: /*#__PURE__*/_jsx(Link, {\n                    href: \"/teacher/courses/course-edit\",\n                    activeClassName: \"active\",\n                    children: /*#__PURE__*/_jsx(\"a\", {\n                      children: \"Edit My Course\"\n                    })\n                  })\n                }), /*#__PURE__*/_jsx(\"li\", {\n                  children: /*#__PURE__*/_jsx(Link, {\n                    href: \"/teacher/course/upload-course-video\",\n                    activeClassName: \"active\",\n                    children: /*#__PURE__*/_jsx(\"a\", {\n                      children: \"Upload Course Video\"\n                    })\n                  })\n                })]\n              })\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"col-md-8 col-lg-8\",\n            children: /*#__PURE__*/_jsxs(\"div\", {\n              className: \"border-box\",\n              children: [imageUploading && /*#__PURE__*/_jsx(\"h3\", {\n                className: \"loading-spinner\",\n                children: /*#__PURE__*/_jsx(\"div\", {\n                  className: \"d-table\",\n                  children: /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"d-table-cell\",\n                    children: [/*#__PURE__*/_jsx(Spinner, {\n                      color: \"primary\"\n                    }), \" Image Uploading....\"]\n                  })\n                })\n              }), loading && /*#__PURE__*/_jsx(\"h3\", {\n                className: \"loading-spinner\",\n                children: /*#__PURE__*/_jsx(\"div\", {\n                  className: \"d-table\",\n                  children: /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"d-table-cell\",\n                    children: [/*#__PURE__*/_jsx(Spinner, {\n                      color: \"success\"\n                    }), \" Wait....\"]\n                  })\n                })\n              }), /*#__PURE__*/_jsxs(\"form\", {\n                onSubmit: handleCourseSubmit,\n                children: [/*#__PURE__*/_jsxs(\"div\", {\n                  className: \"form-group\",\n                  children: [/*#__PURE__*/_jsx(\"label\", {\n                    children: \"Course Title\"\n                  }), /*#__PURE__*/_jsx(\"input\", {\n                    type: \"text\",\n                    placeholder: \"Enter course title\",\n                    className: \"form-control\",\n                    name: \"title\",\n                    value: course.title,\n                    onChange: handleChange\n                  })]\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"form-group\",\n                  children: [/*#__PURE__*/_jsx(\"label\", {\n                    children: \"Course Overview\"\n                  }), /*#__PURE__*/_jsx(\"textarea\", {\n                    type: \"text\",\n                    placeholder: \"Enter course overview\",\n                    className: \"form-control\",\n                    name: \"overview\",\n                    rows: \"10\",\n                    value: course.overview,\n                    onChange: handleChange\n                  })]\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"form-group\",\n                  children: [/*#__PURE__*/_jsx(\"label\", {\n                    children: \"Course Price\"\n                  }), /*#__PURE__*/_jsx(\"input\", {\n                    type: \"number\",\n                    placeholder: \"Enter course price\",\n                    className: \"form-control\",\n                    name: \"price\",\n                    value: course.price,\n                    onChange: handleChange\n                  })]\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"form-group\",\n                  children: [/*#__PURE__*/_jsx(\"label\", {\n                    children: \"Course Lessons\"\n                  }), /*#__PURE__*/_jsx(\"input\", {\n                    type: \"text\",\n                    placeholder: \"30 Lessons\",\n                    className: \"form-control\",\n                    name: \"lessons\",\n                    value: course.lessons,\n                    onChange: handleChange\n                  })]\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"form-group\",\n                  children: [/*#__PURE__*/_jsx(\"label\", {\n                    children: \"Course Duration (Whole numbers of hours & minutes)\"\n                  }), /*#__PURE__*/_jsx(\"input\", {\n                    type: \"text\",\n                    placeholder: \"10 hours 30 minutes\",\n                    className: \"form-control\",\n                    name: \"duration\",\n                    value: course.duration,\n                    onChange: handleChange\n                  })]\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"form-group\",\n                  children: [/*#__PURE__*/_jsx(\"label\", {\n                    children: \"Categories\"\n                  }), /*#__PURE__*/_jsx(\"input\", {\n                    type: \"text\",\n                    placeholder: \"React, Ruby, Rails\",\n                    className: \"form-control\",\n                    name: \"category\",\n                    value: course.category,\n                    onChange: handleChange\n                  })]\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"form-group\",\n                  children: [/*#__PURE__*/_jsxs(\"label\", {\n                    children: [\"Course Profile (\", /*#__PURE__*/_jsx(\"i\", {\n                      children: \"Image less than 2 MB & size 750x500\"\n                    }), \")\"]\n                  }), /*#__PURE__*/_jsx(\"br\", {}), /*#__PURE__*/_jsx(\"input\", {\n                    type: \"file\",\n                    name: \"profilePhoto\",\n                    accept: \"image/*\",\n                    onChange: handleChange\n                  }), /*#__PURE__*/_jsx(\"br\", {}), /*#__PURE__*/_jsx(\"img\", {\n                    src: profilePreview,\n                    className: \"mxw-200 mt-20\"\n                  })]\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"form-group\",\n                  children: [/*#__PURE__*/_jsxs(\"label\", {\n                    children: [\"Course Cover Photo (\", /*#__PURE__*/_jsx(\"i\", {\n                      children: \"Image less than 2 MB & size 1920x500\"\n                    }), \")\"]\n                  }), /*#__PURE__*/_jsx(\"br\", {}), /*#__PURE__*/_jsx(\"input\", {\n                    type: \"file\",\n                    name: \"coverPhoto\",\n                    accept: \"image/*\",\n                    onChange: handleChange\n                  }), /*#__PURE__*/_jsx(\"br\", {}), /*#__PURE__*/_jsx(\"img\", {\n                    src: coverPhotoPreview,\n                    className: \"mxw-200 mt-20\"\n                  })]\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"form-group\",\n                  children: [/*#__PURE__*/_jsx(\"label\", {\n                    children: \"Course Preview Video URL\"\n                  }), /*#__PURE__*/_jsx(\"input\", {\n                    type: \"text\",\n                    placeholder: \"https://www.youtube.com/watch?v=Ke90Tje7VS0\",\n                    className: \"form-control\",\n                    name: \"course_preview_video\",\n                    value: course.course_preview_video,\n                    onChange: handleChange\n                  })]\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"form-group\",\n                  children: [/*#__PURE__*/_jsxs(\"label\", {\n                    children: [\"Course Preview Image (\", /*#__PURE__*/_jsx(\"i\", {\n                      children: \"Image less than 2 MB & size 750x500\"\n                    }), \")\"]\n                  }), /*#__PURE__*/_jsx(\"br\", {}), /*#__PURE__*/_jsx(\"input\", {\n                    type: \"file\",\n                    name: \"course_preview_img\",\n                    accept: \"image/*\",\n                    onChange: handleChange\n                  }), /*#__PURE__*/_jsx(\"br\", {}), /*#__PURE__*/_jsx(\"img\", {\n                    src: coursePreviewImg,\n                    className: \"mxw-200 mt-20\"\n                  })]\n                }), /*#__PURE__*/_jsxs(\"button\", {\n                  className: \"default-btn\",\n                  disabled: imageUploading || disabled || loading,\n                  type: \"submit\",\n                  children: [/*#__PURE__*/_jsx(\"i\", {\n                    className: \"flaticon-right-chevron\"\n                  }), \"Create\", imageUploading || loading ? /*#__PURE__*/_jsx(Spinner, {\n                    color: \"success\"\n                  }) : '', /*#__PURE__*/_jsx(\"span\", {})]\n                })]\n              })]\n            })\n          })]\n        })\n      })\n    })]\n  });\n};\n\nexport default Create;","map":null,"metadata":{},"sourceType":"module"}